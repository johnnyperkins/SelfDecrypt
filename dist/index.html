<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="./lock.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ðŸ”’âš¡ Self Decrypt âš¡ðŸ”’</title>
    <script type="module" crossorigin>(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function ae(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function le(e,t){return Array.isArray(t)?t.length===0?!0:e?t.every(n=>typeof n=="string"):t.every(n=>Number.isSafeInteger(n)):!1}function Pe(e){if(typeof e!="function")throw new Error("function expected");return!0}function lt(e,t){if(typeof t!="string")throw new Error(`${e}: string expected`);return!0}function ue(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}function Ct(e){if(!Array.isArray(e))throw new Error("array expected")}function he(e,t){if(!le(!0,t))throw new Error(`${e}: array of strings expected`)}function de(e,t){if(!le(!1,t))throw new Error(`${e}: array of numbers expected`)}function ye(...e){const t=r=>r,n=(r,s)=>c=>r(s(c)),o=e.map(r=>r.encode).reduceRight(n,t),i=e.map(r=>r.decode).reduce(n,t);return{encode:o,decode:i}}function pe(e){const t=typeof e=="string"?e.split(""):e,n=t.length;he("alphabet",t);const o=new Map(t.map((i,r)=>[i,r]));return{encode:i=>(Ct(i),i.map(r=>{if(!Number.isSafeInteger(r)||r<0||r>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${r}". Allowed: ${e}`);return t[r]})),decode:i=>(Ct(i),i.map(r=>{lt("alphabet.decode",r);const s=o.get(r);if(s===void 0)throw new Error(`Unknown letter: "${r}". Allowed: ${e}`);return s}))}}function we(e=""){return lt("join",e),{encode:t=>(he("join.decode",t),t.join(e)),decode:t=>(lt("join.decode",t),t.split(e))}}const ge=(e,t)=>t===0?e:ge(t,e%t),bt=(e,t)=>e+(t-ge(e,t)),wt=(()=>{let e=[];for(let t=0;t<40;t++)e.push(2**t);return e})();function St(e,t,n,o){if(Ct(e),t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(bt(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${bt(t,n)}`);let i=0,r=0;const s=wt[t],c=wt[n]-1,f=[];for(const a of e){if(ue(a),a>=s)throw new Error(`convertRadix2: invalid data word=${a} from=${t}`);if(i=i<<t|a,r+t>32)throw new Error(`convertRadix2: carry overflow pos=${r} from=${t}`);for(r+=t;r>=n;r-=n)f.push((i>>r-n&c)>>>0);const u=wt[r];if(u===void 0)throw new Error("invalid carry");i&=u-1}if(i=i<<n-r&c,!o&&r>=t)throw new Error("Excess padding");if(!o&&i>0)throw new Error(`Non-zero padding: ${i}`);return o&&r>0&&f.push(i>>>0),f}function be(e,t=!1){if(ue(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(bt(8,e)>32||bt(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!ae(n))throw new Error("radix2.encode input should be Uint8Array");return St(Array.from(n),8,e,!t)},decode:n=>(de("radix2.decode",n),Uint8Array.from(St(n,e,8,t)))}}function Kt(e){return Pe(e),function(...t){try{return e.apply(null,t)}catch{}}}const Et=ye(be(6),pe("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),we("")),Tt=ye(pe("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),we("")),zt=[996825010,642813549,513874426,1027748829,705979059];function at(e){const t=e>>25;let n=(e&33554431)<<5;for(let o=0;o<zt.length;o++)(t>>o&1)===1&&(n^=zt[o]);return n}function Wt(e,t,n=1){const o=e.length;let i=1;for(let r=0;r<o;r++){const s=e.charCodeAt(r);if(s<33||s>126)throw new Error(`Invalid prefix (${e})`);i=at(i)^s>>5}i=at(i);for(let r=0;r<o;r++)i=at(i)^e.charCodeAt(r)&31;for(let r of t)i=at(i)^r;for(let r=0;r<6;r++)i=at(i);return i^=n,Tt.encode(St([i%wt[30]],30,5,!1))}function Ne(e){const t=e==="bech32"?1:734539939,n=be(5),o=n.decode,i=n.encode,r=Kt(o);function s(l,h,w=90){lt("bech32.encode prefix",l),ae(h)&&(h=Array.from(h)),de("bech32.encode",h);const p=l.length;if(p===0)throw new TypeError(`Invalid prefix length ${p}`);const y=p+7+h.length;if(w!==!1&&y>w)throw new TypeError(`Length ${y} exceeds limit ${w}`);const g=l.toLowerCase(),m=Wt(g,h,t);return`${g}1${Tt.encode(h)}${m}`}function c(l,h=90){lt("bech32.decode input",l);const w=l.length;if(w<8||h!==!1&&w>h)throw new TypeError(`invalid string length: ${w} (${l}). Expected (8..${h})`);const p=l.toLowerCase();if(l!==p&&l!==l.toUpperCase())throw new Error("String must be lowercase or uppercase");const y=p.lastIndexOf("1");if(y===0||y===-1)throw new Error('Letter "1" must be present between prefix and data only');const g=p.slice(0,y),m=p.slice(y+1);if(m.length<6)throw new Error("Data must be at least 6 characters long");const b=Tt.decode(m).slice(0,-6),_=Wt(g,b,t);if(!m.endsWith(_))throw new Error(`Invalid checksum in ${l}: expected "${_}"`);return{prefix:g,words:b}}const f=Kt(c);function a(l){const{prefix:h,words:w}=c(l,!1);return{prefix:h,words:w,bytes:o(w)}}function u(l,h){return s(l,i(h))}return{encode:s,decode:c,encodeFromBytes:u,decodeToBytes:a,decodeUnsafe:f,fromWords:o,fromWordsUnsafe:r,toWords:i}}const Re=Ne("bech32");function z(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function $e(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Dt(e,...t){if(!$e(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function At(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");z(e.outputLen),z(e.blockLen)}function xt(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function De(e,t){Dt(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}const ot=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Lt(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function gt(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function V(e,t){return e<<32-t|e>>>t}function M(e,t){return e<<t|e>>>32-t>>>0}const Vt=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Fe(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function Gt(e){for(let t=0;t<e.length;t++)e[t]=Fe(e[t])}function je(e){if(typeof e!="string")throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}function J(e){return typeof e=="string"&&(e=je(e)),Dt(e),e}class xe{clone(){return this._cloneInto()}}function me(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(e,t)}function Ke(e){const t=o=>e().update(J(o)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function ut(e=32){if(ot&&typeof ot.getRandomValues=="function")return ot.getRandomValues(new Uint8Array(e));if(ot&&typeof ot.randomBytes=="function")return ot.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}class Ee extends xe{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,At(t);const o=J(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,r=new Uint8Array(i);r.set(o.length>i?t.create().update(o).digest():o);for(let s=0;s<r.length;s++)r[s]^=54;this.iHash.update(r),this.oHash=t.create();for(let s=0;s<r.length;s++)r[s]^=106;this.oHash.update(r),r.fill(0)}update(t){return xt(this),this.iHash.update(t),this}digestInto(t){xt(this),Dt(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:o,finished:i,destroyed:r,blockLen:s,outputLen:c}=this;return t=t,t.finished=i,t.destroyed=r,t.blockLen=s,t.outputLen=c,t.oHash=n._cloneInto(t.oHash),t.iHash=o._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const ht=(e,t,n)=>new Ee(e,t).update(n).digest();ht.create=(e,t)=>new Ee(e,t);function ze(e,t,n){return At(e),n===void 0&&(n=new Uint8Array(e.outputLen)),ht(e,J(n),J(t))}const Bt=new Uint8Array([0]),qt=new Uint8Array;function We(e,t,n,o=32){if(At(e),z(o),o>255*e.outputLen)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(o/e.outputLen);n===void 0&&(n=qt);const r=new Uint8Array(i*e.outputLen),s=ht.create(e,t),c=s._cloneInto(),f=new Uint8Array(s.outputLen);for(let a=0;a<i;a++)Bt[0]=a+1,c.update(a===0?qt:f).update(n).update(Bt).digestInto(f),r.set(f,e.outputLen*a),s._cloneInto(c);return s.destroy(),c.destroy(),f.fill(0),Bt.fill(0),r.slice(0,o)}const Ht=(e,t,n,o,i)=>We(e,ze(e,t,n),o,i);function Ve(e,t,n,o){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,o);const i=BigInt(32),r=BigInt(4294967295),s=Number(n>>i&r),c=Number(n&r),f=o?4:0,a=o?0:4;e.setUint32(t+f,s,o),e.setUint32(t+a,c,o)}function Ge(e,t,n){return e&t^~e&n}function qe(e,t,n){return e&t^e&n^t&n}class Xe extends xe{constructor(t,n,o,i){super(),this.blockLen=t,this.outputLen=n,this.padOffset=o,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=gt(this.buffer)}update(t){xt(this);const{view:n,buffer:o,blockLen:i}=this;t=J(t);const r=t.length;for(let s=0;s<r;){const c=Math.min(i-this.pos,r-s);if(c===i){const f=gt(t);for(;i<=r-s;s+=i)this.process(f,s);continue}o.set(t.subarray(s,s+c),this.pos),this.pos+=c,s+=c,this.pos===i&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){xt(this),De(t,this),this.finished=!0;const{buffer:n,view:o,blockLen:i,isLE:r}=this;let{pos:s}=this;n[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(o,0),s=0);for(let l=s;l<i;l++)n[l]=0;Ve(o,i-8,BigInt(this.length*8),r),this.process(o,0);const c=gt(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const a=f/4,u=this.get();if(a>u.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<a;l++)c.setUint32(4*l,u[l],r)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const o=t.slice(0,n);return this.destroy(),o}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:o,length:i,finished:r,destroyed:s,pos:c}=this;return t.length=i,t.pos=c,t.finished=r,t.destroyed=s,i%n&&t.buffer.set(o),t}}const Ye=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Y=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Z=new Uint32Array(64);class Ze extends Xe{constructor(){super(64,32,8,!1),this.A=Y[0]|0,this.B=Y[1]|0,this.C=Y[2]|0,this.D=Y[3]|0,this.E=Y[4]|0,this.F=Y[5]|0,this.G=Y[6]|0,this.H=Y[7]|0}get(){const{A:t,B:n,C:o,D:i,E:r,F:s,G:c,H:f}=this;return[t,n,o,i,r,s,c,f]}set(t,n,o,i,r,s,c,f){this.A=t|0,this.B=n|0,this.C=o|0,this.D=i|0,this.E=r|0,this.F=s|0,this.G=c|0,this.H=f|0}process(t,n){for(let l=0;l<16;l++,n+=4)Z[l]=t.getUint32(n,!1);for(let l=16;l<64;l++){const h=Z[l-15],w=Z[l-2],p=V(h,7)^V(h,18)^h>>>3,y=V(w,17)^V(w,19)^w>>>10;Z[l]=y+Z[l-7]+p+Z[l-16]|0}let{A:o,B:i,C:r,D:s,E:c,F:f,G:a,H:u}=this;for(let l=0;l<64;l++){const h=V(c,6)^V(c,11)^V(c,25),w=u+h+Ge(c,f,a)+Ye[l]+Z[l]|0,y=(V(o,2)^V(o,13)^V(o,22))+qe(o,i,r)|0;u=a,a=f,f=c,c=s+w|0,s=r,r=i,i=o,o=w+y|0}o=o+this.A|0,i=i+this.B|0,r=r+this.C|0,s=s+this.D|0,c=c+this.E|0,f=f+this.F|0,a=a+this.G|0,u=u+this.H|0,this.set(o,i,r,s,c,f,a,u)}roundClean(){Z.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const ct=Ke(()=>new Ze);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ae=BigInt(0);function Ft(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function ve(e){if(!Ft(e))throw new Error("Uint8Array expected")}const Qe=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Je(e){ve(e);let t="";for(let n=0;n<e.length;n++)t+=Qe[e[n]];return t}function tn(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?Ae:BigInt("0x"+e)}const X={_0:48,_9:57,A:65,F:70,a:97,f:102};function Xt(e){if(e>=X._0&&e<=X._9)return e-X._0;if(e>=X.A&&e<=X.F)return e-(X.A-10);if(e>=X.a&&e<=X.f)return e-(X.a-10)}function Le(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const o=new Uint8Array(n);for(let i=0,r=0;i<n;i++,r+=2){const s=Xt(e.charCodeAt(r)),c=Xt(e.charCodeAt(r+1));if(s===void 0||c===void 0){const f=e[r]+e[r+1];throw new Error('hex string expected, got non-hex character "'+f+'" at index '+r)}o[i]=s*16+c}return o}function Yt(e){return ve(e),tn(Je(Uint8Array.from(e).reverse()))}function en(e,t){return Le(e.toString(16).padStart(t*2,"0"))}function nn(e,t){return en(e,t).reverse()}function Zt(e,t,n){let o;if(typeof t=="string")try{o=Le(t)}catch(r){throw new Error(e+" must be hex string or Uint8Array, cause: "+r)}else if(Ft(t))o=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");const i=o.length;if(typeof n=="number"&&i!==n)throw new Error(e+" of length "+n+" expected, got "+i);return o}const Ut=e=>typeof e=="bigint"&&Ae<=e;function rn(e,t,n){return Ut(e)&&Ut(t)&&Ut(n)&&t<=e&&e<n}function Qt(e,t,n,o){if(!rn(t,n,o))throw new Error("expected valid "+e+": "+n+" <= n < "+o+", got "+t)}const on={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||Ft(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function sn(e,t,n={}){const o=(i,r,s)=>{const c=on[r];if(typeof c!="function")throw new Error("invalid validator function");const f=e[i];if(!(s&&f===void 0)&&!c(f,e))throw new Error("param "+String(i)+" is invalid. Expected "+r+", got "+f)};for(const[i,r]of Object.entries(t))o(i,r,!1);for(const[i,r]of Object.entries(n))o(i,r,!0);return e}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const st=BigInt(0),dt=BigInt(1);function Be(e,t){const n=e%t;return n>=st?n:t+n}function cn(e,t,n){if(t<st)throw new Error("invalid exponent, negatives unsupported");if(n<=st)throw new Error("invalid modulus");if(n===dt)return st;let o=dt;for(;t>st;)t&dt&&(o=o*e%n),e=e*e%n,t>>=dt;return o}function W(e,t,n){let o=e;for(;t-- >st;)o*=o,o%=n;return o}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const it=BigInt(0),It=BigInt(1);function fn(e){return sn(e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...e})}function an(e){const t=fn(e),{P:n}=t,o=b=>Be(b,n),i=t.montgomeryBits,r=Math.ceil(i/8),s=t.nByteLength,c=t.adjustScalarBytes||(b=>b),f=t.powPminus2||(b=>cn(b,n-BigInt(2),n));function a(b,_,$){const D=o(b*(_-$));return _=o(_-D),$=o($+D),[_,$]}const u=(t.a-BigInt(2))/BigInt(4);function l(b,_){Qt("u",b,it,n),Qt("scalar",_,it,n);const $=_,D=b;let v=It,T=it,H=b,E=It,A=it,x;for(let L=BigInt(i-1);L>=it;L--){const k=$>>L&It;A^=k,x=a(A,v,H),v=x[0],H=x[1],x=a(A,T,E),T=x[0],E=x[1],A=k;const B=v+T,U=o(B*B),I=v-T,C=o(I*I),d=U-C,O=H+E,N=H-E,R=o(N*B),K=o(O*I),G=R+K,q=R-K;H=o(G*G),E=o(D*o(q*q)),v=o(U*C),T=o(d*(U+o(u*d)))}x=a(A,v,H),v=x[0],H=x[1],x=a(A,T,E),T=x[0],E=x[1];const S=f(T);return o(v*S)}function h(b){return nn(o(b),r)}function w(b){const _=Zt("u coordinate",b,r);return s===32&&(_[31]&=127),Yt(_)}function p(b){const _=Zt("scalar",b),$=_.length;if($!==r&&$!==s){let D=""+r+" or "+s;throw new Error("invalid scalar, expected "+D+" bytes, got "+$)}return Yt(c(_))}function y(b,_){const $=w(_),D=p(b),v=l($,D);if(v===it)throw new Error("invalid private or public key received");return h(v)}const g=h(t.Gu);function m(b){return y(b,g)}return{scalarMult:y,scalarMultBase:m,getSharedSecret:(b,_)=>y(b,_),getPublicKey:b=>m(b),utils:{randomPrivateKey:()=>t.randomBytes(t.nByteLength)},GuBytes:g}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ot=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);const ln=BigInt(1),Jt=BigInt(2),un=BigInt(3),hn=BigInt(5);BigInt(8);function dn(e){const t=BigInt(10),n=BigInt(20),o=BigInt(40),i=BigInt(80),r=Ot,c=e*e%r*e%r,f=W(c,Jt,r)*c%r,a=W(f,ln,r)*e%r,u=W(a,hn,r)*a%r,l=W(u,t,r)*u%r,h=W(l,n,r)*l%r,w=W(h,o,r)*h%r,p=W(w,i,r)*w%r,y=W(p,i,r)*w%r,g=W(y,t,r)*u%r;return{pow_p_5_8:W(g,Jt,r)*e%r,b2:c}}function yn(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}const mt=an({P:Ot,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:e=>{const t=Ot,{pow_p_5_8:n,b2:o}=dn(e);return Be(W(n,un,t)*o,t)},adjustScalarBytes:yn,randomBytes:ut});var vt=function(e,t,n,o){function i(r){return r instanceof n?r:new n(function(s){s(r)})}return new(n||(n=Promise))(function(r,s){function c(u){try{a(o.next(u))}catch(l){s(l)}}function f(u){try{a(o.throw(u))}catch(l){s(l)}}function a(u){u.done?r(u.value):i(u.value).then(c,f)}a((o=o.apply(e,t||[])).next())})};const jt=!1;let Ue=!1;const Ie=(()=>{let e;return()=>vt(void 0,void 0,void 0,function*(){if(e===void 0)try{yield crypto.subtle.importKey("raw",mt.GuBytes,{name:"X25519"},jt,[]),e=!0}catch{e=!1}return e})})();function _e(e,t){return vt(this,void 0,void 0,function*(){if(!(yield Ie())||Ue){if(Mt(e))throw new Error("CryptoKey provided but X25519 WebCrypto is not supported");return mt.scalarMult(e,t)}let n;Mt(e)?n=e:n=yield gn(e);const o=yield crypto.subtle.importKey("raw",t,{name:"X25519"},jt,[]);return new Uint8Array(yield crypto.subtle.deriveBits({name:"X25519",public:o},n,256))})}function pn(e){return vt(this,void 0,void 0,function*(){if(!(yield Ie())||Ue){if(Mt(e))throw new Error("CryptoKey provided but X25519 WebCrypto is not supported");return mt.scalarMultBase(e)}return _e(e,mt.GuBytes)})}const wn=new Uint8Array([48,46,2,1,0,48,5,6,3,43,101,110,4,34,4,32]);function gn(e){return vt(this,void 0,void 0,function*(){if(e.length!==32)throw new Error("X25519 private key must be 32 bytes");const t=new Uint8Array([...wn,...e]);return crypto.subtle.importKey("pkcs8",t,{name:"X25519"},jt,["deriveBits"])})}function Mt(e){return typeof CryptoKey<"u"&&e instanceof CryptoKey}function bn(e,t,n,o){At(e);const i=me({dkLen:32,asyncTick:10},o),{c:r,dkLen:s,asyncTick:c}=i;if(z(r),z(s),z(c),r<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const f=J(t),a=J(n),u=new Uint8Array(s),l=ht.create(e,f),h=l._cloneInto().update(a);return{c:r,dkLen:s,asyncTick:c,DK:u,PRF:l,PRFSalt:h}}function xn(e,t,n,o,i){return e.destroy(),t.destroy(),o&&o.destroy(),i.fill(0),n}function ke(e,t,n,o){const{c:i,dkLen:r,DK:s,PRF:c,PRFSalt:f}=bn(e,t,n,o);let a;const u=new Uint8Array(4),l=gt(u),h=new Uint8Array(c.outputLen);for(let w=1,p=0;p<r;w++,p+=c.outputLen){const y=s.subarray(p,p+c.outputLen);l.setInt32(0,w,!1),(a=f._cloneInto(a)).update(u).digestInto(h),y.set(h.subarray(0,y.length));for(let g=1;g<i;g++){c._cloneInto(a).update(h).digestInto(h);for(let m=0;m<y.length;m++)y[m]^=h[m]}}return xn(c,f,s,a,h)}function te(e,t,n,o,i,r){let s=e[t++]^n[o++],c=e[t++]^n[o++],f=e[t++]^n[o++],a=e[t++]^n[o++],u=e[t++]^n[o++],l=e[t++]^n[o++],h=e[t++]^n[o++],w=e[t++]^n[o++],p=e[t++]^n[o++],y=e[t++]^n[o++],g=e[t++]^n[o++],m=e[t++]^n[o++],b=e[t++]^n[o++],_=e[t++]^n[o++],$=e[t++]^n[o++],D=e[t++]^n[o++],v=s,T=c,H=f,E=a,A=u,x=l,S=h,L=w,k=p,B=y,U=g,I=m,C=b,d=_,O=$,N=D;for(let R=0;R<8;R+=2)A^=M(v+C|0,7),k^=M(A+v|0,9),C^=M(k+A|0,13),v^=M(C+k|0,18),B^=M(x+T|0,7),d^=M(B+x|0,9),T^=M(d+B|0,13),x^=M(T+d|0,18),O^=M(U+S|0,7),H^=M(O+U|0,9),S^=M(H+O|0,13),U^=M(S+H|0,18),E^=M(N+I|0,7),L^=M(E+N|0,9),I^=M(L+E|0,13),N^=M(I+L|0,18),T^=M(v+E|0,7),H^=M(T+v|0,9),E^=M(H+T|0,13),v^=M(E+H|0,18),S^=M(x+A|0,7),L^=M(S+x|0,9),A^=M(L+S|0,13),x^=M(A+L|0,18),I^=M(U+B|0,7),k^=M(I+U|0,9),B^=M(k+I|0,13),U^=M(B+k|0,18),C^=M(N+O|0,7),d^=M(C+N|0,9),O^=M(d+C|0,13),N^=M(O+d|0,18);i[r++]=s+v|0,i[r++]=c+T|0,i[r++]=f+H|0,i[r++]=a+E|0,i[r++]=u+A|0,i[r++]=l+x|0,i[r++]=h+S|0,i[r++]=w+L|0,i[r++]=p+k|0,i[r++]=y+B|0,i[r++]=g+U|0,i[r++]=m+I|0,i[r++]=b+C|0,i[r++]=_+d|0,i[r++]=$+O|0,i[r++]=D+N|0}function _t(e,t,n,o,i){let r=o+0,s=o+16*i;for(let c=0;c<16;c++)n[s+c]=e[t+(2*i-1)*16+c];for(let c=0;c<i;c++,r+=16,t+=16)te(n,s,e,t,n,r),c>0&&(s+=16),te(n,r,e,t+=16,n,s)}function mn(e,t,n){const o=me({dkLen:32,asyncTick:10,maxmem:1073742848},n),{N:i,r,p:s,dkLen:c,asyncTick:f,maxmem:a,onProgress:u}=o;if(z(i),z(r),z(s),z(c),z(f),z(a),u!==void 0&&typeof u!="function")throw new Error("progressCb should be function");const l=128*r,h=l/4;if(i<=1||i&i-1||i>2**32)throw new Error("Scrypt: N must be larger than 1, a power of 2, and less than 2^32");if(s<0||s>(2**32-1)*32/l)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(c<0||c>(2**32-1)*32)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");if(l*(i+s)>a)throw new Error("Scrypt: memused is bigger than maxMem. Expected 128 * r * (N + p) > maxmem of "+a);const p=ke(ct,e,t,{c:1,dkLen:l*s}),y=Lt(p),g=Lt(new Uint8Array(l*i)),m=Lt(new Uint8Array(l));let b=()=>{};if(u){const _=2*i*s,$=Math.max(Math.floor(_/1e4),1);let D=0;b=()=>{D++,u&&(!(D%$)||D===_)&&u(D/_)}}return{N:i,r,p:s,dkLen:c,blockSize32:h,V:g,B32:y,B:p,tmp:m,blockMixCb:b,asyncTick:f}}function En(e,t,n,o,i){const r=ke(ct,e,n,{c:1,dkLen:t});return n.fill(0),o.fill(0),i.fill(0),r}function An(e,t,n){const{N:o,r:i,p:r,dkLen:s,blockSize32:c,V:f,B32:a,B:u,tmp:l,blockMixCb:h}=mn(e,t,n);Vt||Gt(a);for(let w=0;w<r;w++){const p=c*w;for(let y=0;y<c;y++)f[y]=a[p+y];for(let y=0,g=0;y<o-1;y++)_t(f,g,f,g+=c,i),h();_t(f,(o-1)*c,a,p,i),h();for(let y=0;y<o;y++){const g=a[p+c-16]%o;for(let m=0;m<c;m++)l[m]=a[p+m]^f[g*c+m];_t(l,0,a,p,i),h()}}return Vt||Gt(a),En(e,s,u,f,l)}function kt(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Ce(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function j(e,...t){if(!Ce(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function ee(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function vn(e,t){j(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function ne(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */const Q=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),Ln=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),Bn=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Bn)throw new Error("Non little-endian hardware is not supported");function Un(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function Pt(e){if(typeof e=="string")e=Un(e);else if(Ce(e))e=Nt(e);else throw new Error("Uint8Array expected, got "+typeof e);return e}function In(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}function _n(e,t){if(e.length!==t.length)return!1;let n=0;for(let o=0;o<e.length;o++)n|=e[o]^t[o];return n===0}const kn=(e,t)=>{function n(o,...i){if(j(o),e.nonceLength!==void 0){const u=i[0];if(!u)throw new Error("nonce / iv required");e.varSizeNonce?j(u):j(u,e.nonceLength)}const r=e.tagLength;r&&i[1]!==void 0&&j(i[1]);const s=t(o,...i),c=(u,l)=>{if(l!==void 0){if(u!==2)throw new Error("cipher output not supported");j(l)}};let f=!1;return{encrypt(u,l){if(f)throw new Error("cannot encrypt() twice with same key + nonce");return f=!0,j(u),c(s.encrypt.length,l),s.encrypt(u,l)},decrypt(u,l){if(j(u),r&&u.length<r)throw new Error("invalid ciphertext length: smaller than tagLength="+r);return c(s.decrypt.length,l),s.decrypt(u,l)}}}return Object.assign(n,e),n};function re(e,t,n=!0){if(t===void 0)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(n&&!Cn(t))throw new Error("invalid output, must be aligned");return t}function oe(e,t,n,o){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,o);const i=BigInt(32),r=BigInt(4294967295),s=Number(n>>i&r),c=Number(n&r),f=4,a=0;e.setUint32(t+f,s,o),e.setUint32(t+a,c,o)}function Cn(e){return e.byteOffset%4===0}function Nt(e){return Uint8Array.from(e)}function ft(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}const Se=e=>Uint8Array.from(e.split("").map(t=>t.charCodeAt(0))),Sn=Se("expand 16-byte k"),Tn=Se("expand 32-byte k"),Hn=Q(Sn),On=Q(Tn);function P(e,t){return e<<t|e>>>32-t}function Rt(e){return e.byteOffset%4===0}const yt=64,Mn=16,Te=2**32-1,ie=new Uint32Array;function Pn(e,t,n,o,i,r,s,c){const f=i.length,a=new Uint8Array(yt),u=Q(a),l=Rt(i)&&Rt(r),h=l?Q(i):ie,w=l?Q(r):ie;for(let p=0;p<f;s++){if(e(t,n,o,u,s,c),s>=Te)throw new Error("arx: counter overflow");const y=Math.min(yt,f-p);if(l&&y===yt){const g=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let m=0,b;m<Mn;m++)b=g+m,w[b]=h[b]^u[m];p+=yt;continue}for(let g=0,m;g<y;g++)m=p+g,r[m]=i[m]^a[g];p+=y}}function Nn(e,t){const{allowShortKeys:n,extendNonceFn:o,counterLength:i,counterRight:r,rounds:s}=In({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return kt(i),kt(s),ne(r),ne(n),(c,f,a,u,l=0)=>{j(c),j(f),j(a);const h=a.length;if(u===void 0&&(u=new Uint8Array(h)),j(u),kt(l),l<0||l>=Te)throw new Error("arx: counter overflow");if(u.length<h)throw new Error(`arx: output (${u.length}) is shorter than data (${h})`);const w=[];let p=c.length,y,g;if(p===32)w.push(y=Nt(c)),g=On;else if(p===16&&n)y=new Uint8Array(32),y.set(c),y.set(c,16),g=Hn,w.push(y);else throw new Error(`arx: invalid 32-byte key, got length=${p}`);Rt(f)||w.push(f=Nt(f));const m=Q(y);if(o){if(f.length!==24)throw new Error("arx: extended nonce must be 24 bytes");o(g,m,Q(f.subarray(0,16)),m),f=f.subarray(16)}const b=16-i;if(b!==f.length)throw new Error(`arx: nonce must be ${b} or 16 bytes`);if(b!==12){const $=new Uint8Array(12);$.set(f,r?0:12-f.length),f=$,w.push(f)}const _=Q(f);return Pn(e,g,m,_,a,u,l,s),ft(...w),u}}const F=(e,t)=>e[t++]&255|(e[t++]&255)<<8;class Rn{constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=Pt(t),j(t,32);const n=F(t,0),o=F(t,2),i=F(t,4),r=F(t,6),s=F(t,8),c=F(t,10),f=F(t,12),a=F(t,14);this.r[0]=n&8191,this.r[1]=(n>>>13|o<<3)&8191,this.r[2]=(o>>>10|i<<6)&7939,this.r[3]=(i>>>7|r<<9)&8191,this.r[4]=(r>>>4|s<<12)&255,this.r[5]=s>>>1&8190,this.r[6]=(s>>>14|c<<2)&8191,this.r[7]=(c>>>11|f<<5)&8065,this.r[8]=(f>>>8|a<<8)&8191,this.r[9]=a>>>5&127;for(let u=0;u<8;u++)this.pad[u]=F(t,16+2*u)}process(t,n,o=!1){const i=o?0:2048,{h:r,r:s}=this,c=s[0],f=s[1],a=s[2],u=s[3],l=s[4],h=s[5],w=s[6],p=s[7],y=s[8],g=s[9],m=F(t,n+0),b=F(t,n+2),_=F(t,n+4),$=F(t,n+6),D=F(t,n+8),v=F(t,n+10),T=F(t,n+12),H=F(t,n+14);let E=r[0]+(m&8191),A=r[1]+((m>>>13|b<<3)&8191),x=r[2]+((b>>>10|_<<6)&8191),S=r[3]+((_>>>7|$<<9)&8191),L=r[4]+(($>>>4|D<<12)&8191),k=r[5]+(D>>>1&8191),B=r[6]+((D>>>14|v<<2)&8191),U=r[7]+((v>>>11|T<<5)&8191),I=r[8]+((T>>>8|H<<8)&8191),C=r[9]+(H>>>5|i),d=0,O=d+E*c+A*(5*g)+x*(5*y)+S*(5*p)+L*(5*w);d=O>>>13,O&=8191,O+=k*(5*h)+B*(5*l)+U*(5*u)+I*(5*a)+C*(5*f),d+=O>>>13,O&=8191;let N=d+E*f+A*c+x*(5*g)+S*(5*y)+L*(5*p);d=N>>>13,N&=8191,N+=k*(5*w)+B*(5*h)+U*(5*l)+I*(5*u)+C*(5*a),d+=N>>>13,N&=8191;let R=d+E*a+A*f+x*c+S*(5*g)+L*(5*y);d=R>>>13,R&=8191,R+=k*(5*p)+B*(5*w)+U*(5*h)+I*(5*l)+C*(5*u),d+=R>>>13,R&=8191;let K=d+E*u+A*a+x*f+S*c+L*(5*g);d=K>>>13,K&=8191,K+=k*(5*y)+B*(5*p)+U*(5*w)+I*(5*h)+C*(5*l),d+=K>>>13,K&=8191;let G=d+E*l+A*u+x*a+S*f+L*c;d=G>>>13,G&=8191,G+=k*(5*g)+B*(5*y)+U*(5*p)+I*(5*w)+C*(5*h),d+=G>>>13,G&=8191;let q=d+E*h+A*l+x*u+S*a+L*f;d=q>>>13,q&=8191,q+=k*c+B*(5*g)+U*(5*y)+I*(5*p)+C*(5*w),d+=q>>>13,q&=8191;let tt=d+E*w+A*h+x*l+S*u+L*a;d=tt>>>13,tt&=8191,tt+=k*f+B*c+U*(5*g)+I*(5*y)+C*(5*p),d+=tt>>>13,tt&=8191;let et=d+E*p+A*w+x*h+S*l+L*u;d=et>>>13,et&=8191,et+=k*a+B*f+U*c+I*(5*g)+C*(5*y),d+=et>>>13,et&=8191;let nt=d+E*y+A*p+x*w+S*h+L*l;d=nt>>>13,nt&=8191,nt+=k*u+B*a+U*f+I*c+C*(5*g),d+=nt>>>13,nt&=8191;let rt=d+E*g+A*y+x*p+S*w+L*h;d=rt>>>13,rt&=8191,rt+=k*l+B*u+U*a+I*f+C*c,d+=rt>>>13,rt&=8191,d=(d<<2)+d|0,d=d+O|0,O=d&8191,d=d>>>13,N+=d,r[0]=O,r[1]=N,r[2]=R,r[3]=K,r[4]=G,r[5]=q,r[6]=tt,r[7]=et,r[8]=nt,r[9]=rt}finalize(){const{h:t,pad:n}=this,o=new Uint16Array(10);let i=t[1]>>>13;t[1]&=8191;for(let c=2;c<10;c++)t[c]+=i,i=t[c]>>>13,t[c]&=8191;t[0]+=i*5,i=t[0]>>>13,t[0]&=8191,t[1]+=i,i=t[1]>>>13,t[1]&=8191,t[2]+=i,o[0]=t[0]+5,i=o[0]>>>13,o[0]&=8191;for(let c=1;c<10;c++)o[c]=t[c]+i,i=o[c]>>>13,o[c]&=8191;o[9]-=8192;let r=(i^1)-1;for(let c=0;c<10;c++)o[c]&=r;r=~r;for(let c=0;c<10;c++)t[c]=t[c]&r|o[c];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let s=t[0]+n[0];t[0]=s&65535;for(let c=1;c<8;c++)s=(t[c]+n[c]|0)+(s>>>16)|0,t[c]=s&65535;ft(o)}update(t){ee(this);const{buffer:n,blockLen:o}=this;t=Pt(t);const i=t.length;for(let r=0;r<i;){const s=Math.min(o-this.pos,i-r);if(s===o){for(;o<=i-r;r+=o)this.process(t,r);continue}n.set(t.subarray(r,r+s),this.pos),this.pos+=s,r+=s,this.pos===o&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){ft(this.h,this.r,this.buffer,this.pad)}digestInto(t){ee(this),vn(t,this),this.finished=!0;const{buffer:n,h:o}=this;let{pos:i}=this;if(i){for(n[i++]=1;i<16;i++)n[i]=0;this.process(n,0,!0)}this.finalize();let r=0;for(let s=0;s<8;s++)t[r++]=o[s]>>>0,t[r++]=o[s]>>>8;return t}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const o=t.slice(0,n);return this.destroy(),o}}function $n(e){const t=(o,i)=>e(i).update(Pt(o)).digest(),n=e(new Uint8Array(32));return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=o=>e(o),t}const Dn=$n(e=>new Rn(e));function Fn(e,t,n,o,i,r=20){let s=e[0],c=e[1],f=e[2],a=e[3],u=t[0],l=t[1],h=t[2],w=t[3],p=t[4],y=t[5],g=t[6],m=t[7],b=i,_=n[0],$=n[1],D=n[2],v=s,T=c,H=f,E=a,A=u,x=l,S=h,L=w,k=p,B=y,U=g,I=m,C=b,d=_,O=$,N=D;for(let K=0;K<r;K+=2)v=v+A|0,C=P(C^v,16),k=k+C|0,A=P(A^k,12),v=v+A|0,C=P(C^v,8),k=k+C|0,A=P(A^k,7),T=T+x|0,d=P(d^T,16),B=B+d|0,x=P(x^B,12),T=T+x|0,d=P(d^T,8),B=B+d|0,x=P(x^B,7),H=H+S|0,O=P(O^H,16),U=U+O|0,S=P(S^U,12),H=H+S|0,O=P(O^H,8),U=U+O|0,S=P(S^U,7),E=E+L|0,N=P(N^E,16),I=I+N|0,L=P(L^I,12),E=E+L|0,N=P(N^E,8),I=I+N|0,L=P(L^I,7),v=v+x|0,N=P(N^v,16),U=U+N|0,x=P(x^U,12),v=v+x|0,N=P(N^v,8),U=U+N|0,x=P(x^U,7),T=T+S|0,C=P(C^T,16),I=I+C|0,S=P(S^I,12),T=T+S|0,C=P(C^T,8),I=I+C|0,S=P(S^I,7),H=H+L|0,d=P(d^H,16),k=k+d|0,L=P(L^k,12),H=H+L|0,d=P(d^H,8),k=k+d|0,L=P(L^k,7),E=E+A|0,O=P(O^E,16),B=B+O|0,A=P(A^B,12),E=E+A|0,O=P(O^E,8),B=B+O|0,A=P(A^B,7);let R=0;o[R++]=s+v|0,o[R++]=c+T|0,o[R++]=f+H|0,o[R++]=a+E|0,o[R++]=u+A|0,o[R++]=l+x|0,o[R++]=h+S|0,o[R++]=w+L|0,o[R++]=p+k|0,o[R++]=y+B|0,o[R++]=g+U|0,o[R++]=m+I|0,o[R++]=b+C|0,o[R++]=_+d|0,o[R++]=$+O|0,o[R++]=D+N|0}const jn=Nn(Fn,{counterRight:!1,counterLength:4,allowShortKeys:!1}),Kn=new Uint8Array(16),se=(e,t)=>{e.update(t);const n=t.length%16;n&&e.update(Kn.subarray(n))},zn=new Uint8Array(32);function ce(e,t,n,o,i){const r=e(t,n,zn),s=Dn.create(r);i&&se(s,i),se(s,o);const c=new Uint8Array(16),f=Ln(c);oe(f,0,BigInt(i?i.length:0),!0),oe(f,8,BigInt(o.length),!0),s.update(c);const a=s.digest();return ft(r,c),a}const Wn=e=>(t,n,o)=>({encrypt(r,s){const c=r.length;s=re(c+16,s,!1),s.set(r);const f=s.subarray(0,-16);e(t,n,f,f,1);const a=ce(e,t,n,f,o);return s.set(a,c),ft(a),s},decrypt(r,s){s=re(r.length-16,s,!1);const c=r.subarray(0,-16),f=r.subarray(-16),a=ce(e,t,n,c,o);if(!_n(f,a))throw new Error("invalid tag");return s.set(r.subarray(0,-16)),e(t,n,s,s,1),ft(a),s}}),$t=kn({blockSize:64,nonceLength:12,tagLength:16},Wn(jn));class He{constructor(t,n){this.args=t,this.body=n}}function Vn(e){const t=e.reduce((i,r)=>i+r.length,0),n=new Uint8Array(t);let o=0;for(const i of e)n.set(i,o),o+=i.length;return n}function Oe(e){const t=[];t.push(`age-encryption.org/v1
`);for(const n of e){t.push("-> "+n.args.join(" ")+`
`);for(let o=0;o<n.body.length;o+=48){let i=o+48;i>n.body.length&&(i=n.body.length),t.push(Et.encode(n.body.subarray(o,i))+`
`)}n.body.length%48===0&&t.push(`
`)}return t.push("---"),new TextEncoder().encode(t.join(""))}function Gn(e,t){return Vn([Oe(e),new TextEncoder().encode(" "+Et.encode(t)+`
`)])}var qn=function(e,t,n,o){function i(r){return r instanceof n?r:new n(function(s){s(r)})}return new(n||(n=Promise))(function(r,s){function c(u){try{a(o.next(u))}catch(l){s(l)}}function f(u){try{a(o.throw(u))}catch(l){s(l)}}function a(u){u.done?r(u.value):i(u.value).then(c,f)}a((o=o.apply(e,t||[])).next())})};function Xn(e,t){return qn(this,void 0,void 0,function*(){const n=ut(32),o=yield pn(n),i=yield _e(n,t),r=new Uint8Array(o.length+t.length);r.set(o),r.set(t,o.length);const s=Ht(ct,i,r,"age-encryption.org/v1/X25519",32);return new He(["X25519",Et.encode(o)],Me(e,s))})}function Yn(e,t,n){const o=ut(16),i="age-encryption.org/v1/scrypt",r=new Uint8Array(i.length+16);r.set(new TextEncoder().encode(i)),r.set(o,i.length);const s=An(t,r,{N:Math.pow(2,n),r:8,p:1,dkLen:32});return new He(["scrypt",Et.encode(o),n.toString()],Me(e,s))}function Me(e,t){const n=new Uint8Array(12);return $t(t,n).encrypt(e)}const Zn=16,pt=64*1024;function Qn(e,t){const n=new Uint8Array(12),o=()=>{for(let a=n.length-2;a>=0&&(n[a]++,n[a]===0);a--);},r=(t.length===0?1:Math.ceil(t.length/pt))*Zn,s=new Uint8Array(t.length+r);let c=s;for(;t.length>pt;){const a=$t(e,n).encrypt(t.subarray(0,pt));c.set(a),c=c.subarray(a.length),t=t.subarray(pt),o()}n[11]=1;const f=$t(e,n).encrypt(t);if(c.set(f),c.length!==f.length)throw Error("stream: internal error: didn't fill expected ciphertext buffer");return s}var Jn=function(e,t,n,o){function i(r){return r instanceof n?r:new n(function(s){s(r)})}return new(n||(n=Promise))(function(r,s){function c(u){try{a(o.next(u))}catch(l){s(l)}}function f(u){try{a(o.throw(u))}catch(l){s(l)}}function a(u){u.done?r(u.value):i(u.value).then(c,f)}a((o=o.apply(e,t||[])).next())})};class tr{constructor(){this.passphrase=null,this.scryptWorkFactor=18,this.recipients=[]}setPassphrase(t){if(this.passphrase!==null)throw new Error("can encrypt to at most one passphrase");if(this.recipients.length!==0)throw new Error("can't encrypt to both recipients and passphrases");this.passphrase=t}setScryptWorkFactor(t){this.scryptWorkFactor=t}addRecipient(t){if(this.passphrase!==null)throw new Error("can't encrypt to both recipients and passphrases");const n=Re.decodeToBytes(t);if(!t.startsWith("age1")||n.prefix.toLowerCase()!=="age"||n.bytes.length!==32)throw Error("invalid recipient");this.recipients.push(n.bytes)}encrypt(t){return Jn(this,void 0,void 0,function*(){typeof t=="string"&&(t=new TextEncoder().encode(t));const n=ut(16),o=[];for(const l of this.recipients)o.push(yield Xn(n,l));this.passphrase!==null&&o.push(Yn(n,this.passphrase,this.scryptWorkFactor));const i=Ht(ct,n,void 0,"header",32),r=ht(ct,i,Oe(o)),s=Gn(o,r),c=ut(16),f=Ht(ct,n,c,"payload",32),a=Qn(f,t),u=new Uint8Array(s.length+c.length+a.length);return u.set(s),u.set(c,s.length),u.set(a,s.length+c.length),u})}}const er=async(e,t)=>{try{const n=new tr;n.setPassphrase(t);const o=await e.arrayBuffer();return{success:!0,value:await n.encrypt(new Uint8Array(o))}}catch{return{success:!1,error:"EncryptionFailed"}}},nr=(e,t,n,o)=>{const i=new Blob([e],{type:"text/html"}),r=URL.createObjectURL(i);n.href=r,n.download=t,o.style.display="block"},rr=()=>{const e=document.getElementById("fileInput"),t=document.getElementById("passwordInput"),n=document.getElementById("encryptButton"),o=document.getElementById("downloadLinkContainer"),i=document.getElementById("downloadLink");return{fileInput:e,passwordInput:t,encryptButton:n,downloadLinkContainer:o,downloadLink:i}},or="Encrypt File",ir="Encrypting...",fe=(e,t)=>{e.textContent=t?ir:or,e.disabled=t},sr=e=>{let t="";const n=new Uint8Array(e),o=n.byteLength;for(let i=0;i<o;i++)t+=String.fromCharCode(n[i]);return btoa(t)},cr=(e,t)=>{let n=e;for(const[o,i]of Object.entries(t))n=n.replaceAll(o,i);return n},fr=(e=0)=>new Promise(t=>setTimeout(t,e)),ar='"use strict";var decryptScriptBundle=(()=>{function xe(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function we(e,t){return Array.isArray(t)?t.length===0?!0:e?t.every(n=>typeof n=="string"):t.every(n=>Number.isSafeInteger(n)):!1}function En(e){if(typeof e!="function")throw new Error("function expected");return!0}function gt(e,t){if(typeof t!="string")throw new Error(`${e}: string expected`);return!0}function me(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}function Pt(e){if(!Array.isArray(e))throw new Error("array expected")}function be(e,t){if(!we(!0,t))throw new Error(`${e}: array of strings expected`)}function Ee(e,t){if(!we(!1,t))throw new Error(`${e}: array of numbers expected`)}function Be(...e){let t=o=>o,n=(o,i)=>c=>o(i(c)),r=e.map(o=>o.encode).reduceRight(n,t),s=e.map(o=>o.decode).reduce(n,t);return{encode:r,decode:s}}function Ae(e){let t=typeof e=="string"?e.split(""):e,n=t.length;be("alphabet",t);let r=new Map(t.map((s,o)=>[s,o]));return{encode:s=>(Pt(s),s.map(o=>{if(!Number.isSafeInteger(o)||o<0||o>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${o}". Allowed: ${e}`);return t[o]})),decode:s=>(Pt(s),s.map(o=>{gt("alphabet.decode",o);let i=r.get(o);if(i===void 0)throw new Error(`Unknown letter: "${o}". Allowed: ${e}`);return i}))}}function Le(e=""){return gt("join",e),{encode:t=>(be("join.decode",t),t.join(e)),decode:t=>(gt("join.decode",t),t.split(e))}}var ve=(e,t)=>t===0?e:ve(t,e%t),At=(e,t)=>e+(t-ve(e,t)),Bt=(()=>{let e=[];for(let t=0;t<40;t++)e.push(2**t);return e})();function qt(e,t,n,r){if(Pt(e),t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(At(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${At(t,n)}`);let s=0,o=0,i=Bt[t],c=Bt[n]-1,f=[];for(let a of e){if(me(a),a>=i)throw new Error(`convertRadix2: invalid data word=${a} from=${t}`);if(s=s<<t|a,o+t>32)throw new Error(`convertRadix2: carry overflow pos=${o} from=${t}`);for(o+=t;o>=n;o-=n)f.push((s>>o-n&c)>>>0);let u=Bt[o];if(u===void 0)throw new Error("invalid carry");s&=u-1}if(s=s<<n-o&c,!r&&o>=t)throw new Error("Excess padding");if(!r&&s>0)throw new Error(`Non-zero padding: ${s}`);return r&&o>0&&f.push(s>>>0),f}function Ue(e,t=!1){if(me(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(At(8,e)>32||At(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!xe(n))throw new Error("radix2.encode input should be Uint8Array");return qt(Array.from(n),8,e,!t)},decode:n=>(Ee("radix2.decode",n),Uint8Array.from(qt(n,e,8,t)))}}function pe(e){return En(e),function(...t){try{return e.apply(null,t)}catch{}}}var at=Be(Ue(6),Ae("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Le(""));var Ft=Be(Ae("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),Le("")),ye=[996825010,642813549,513874426,1027748829,705979059];function yt(e){let t=e>>25,n=(e&33554431)<<5;for(let r=0;r<ye.length;r++)(t>>r&1)===1&&(n^=ye[r]);return n}function ge(e,t,n=1){let r=e.length,s=1;for(let o=0;o<r;o++){let i=e.charCodeAt(o);if(i<33||i>126)throw new Error(`Invalid prefix (${e})`);s=yt(s)^i>>5}s=yt(s);for(let o=0;o<r;o++)s=yt(s)^e.charCodeAt(o)&31;for(let o of t)s=yt(s)^o;for(let o=0;o<6;o++)s=yt(s);return s^=n,Ft.encode(qt([s%Bt[30]],30,5,!1))}function Bn(e){let t=e==="bech32"?1:734539939,n=Ue(5),r=n.decode,s=n.encode,o=pe(r);function i(l,d,y=90){gt("bech32.encode prefix",l),xe(d)&&(d=Array.from(d)),Ee("bech32.encode",d);let p=l.length;if(p===0)throw new TypeError(`Invalid prefix length ${p}`);let h=p+7+d.length;if(y!==!1&&h>y)throw new TypeError(`Length ${h} exceeds limit ${y}`);let w=l.toLowerCase(),b=ge(w,d,t);return`${w}1${Ft.encode(d)}${b}`}function c(l,d=90){gt("bech32.decode input",l);let y=l.length;if(y<8||d!==!1&&y>d)throw new TypeError(`invalid string length: ${y} (${l}). Expected (8..${d})`);let p=l.toLowerCase();if(l!==p&&l!==l.toUpperCase())throw new Error("String must be lowercase or uppercase");let h=p.lastIndexOf("1");if(h===0||h===-1)throw new Error(\'Letter "1" must be present between prefix and data only\');let w=p.slice(0,h),b=p.slice(h+1);if(b.length<6)throw new Error("Data must be at least 6 characters long");let m=Ft.decode(b).slice(0,-6),E=ge(w,m,t);if(!b.endsWith(E))throw new Error(`Invalid checksum in ${l}: expected "${E}"`);return{prefix:w,words:m}}let f=pe(c);function a(l){let{prefix:d,words:y}=c(l,!1);return{prefix:d,words:y,bytes:r(y)}}function u(l,d){return i(l,s(d))}return{encode:i,decode:c,encodeFromBytes:u,decodeToBytes:a,decodeUnsafe:f,fromWords:r,fromWordsUnsafe:o,toWords:s}}var Te=Bn("bech32");function V(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function An(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function xt(e,...t){if(!An(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function rt(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");V(e.outputLen),V(e.blockLen)}function lt(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function _e(e,t){xt(e);let n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}var ot=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function Lt(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function dt(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function W(e,t){return e<<32-t|e>>>t}function N(e,t){return e<<t|e>>>32-t>>>0}var Kt=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Ln(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function Vt(e){for(let t=0;t<e.length;t++)e[t]=Ln(e[t])}function Ie(e){if(typeof e!="string")throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}function $(e){return typeof e=="string"&&(e=Ie(e)),xt(e),e}var ut=class{clone(){return this._cloneInto()}};function vt(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(e,t)}function Ce(e){let t=r=>e().update($(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Se(e=32){if(ot&&typeof ot.getRandomValues=="function")return ot.getRandomValues(new Uint8Array(e));if(ot&&typeof ot.randomBytes=="function")return ot.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}var Ut=class extends ut{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,rt(t);let r=$(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let s=this.blockLen,o=new Uint8Array(s);o.set(r.length>s?t.create().update(r).digest():r);for(let i=0;i<o.length;i++)o[i]^=54;this.iHash.update(o),this.oHash=t.create();for(let i=0;i<o.length;i++)o[i]^=106;this.oHash.update(o),o.fill(0)}update(t){return lt(this),this.iHash.update(t),this}digestInto(t){lt(this),xt(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:n,iHash:r,finished:s,destroyed:o,blockLen:i,outputLen:c}=this;return t=t,t.finished=s,t.destroyed=o,t.blockLen=i,t.outputLen=c,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},tt=(e,t,n)=>new Ut(e,t).update(n).digest();tt.create=(e,t)=>new Ut(e,t);function vn(e,t,n){return rt(e),n===void 0&&(n=new Uint8Array(e.outputLen)),tt(e,$(n),$(t))}var jt=new Uint8Array([0]),ke=new Uint8Array;function Un(e,t,n,r=32){if(rt(e),V(r),r>255*e.outputLen)throw new Error("Length should be <= 255*HashLen");let s=Math.ceil(r/e.outputLen);n===void 0&&(n=ke);let o=new Uint8Array(s*e.outputLen),i=tt.create(e,t),c=i._cloneInto(),f=new Uint8Array(i.outputLen);for(let a=0;a<s;a++)jt[0]=a+1,c.update(a===0?ke:f).update(n).update(jt).digestInto(f),o.set(f,e.outputLen*a),i._cloneInto(c);return i.destroy(),c.destroy(),f.fill(0),jt.fill(0),o.slice(0,r)}var wt=(e,t,n,r,s)=>Un(e,vn(e,t,n),r,s);function Tn(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let s=BigInt(32),o=BigInt(4294967295),i=Number(n>>s&o),c=Number(n&o),f=r?4:0,a=r?0:4;e.setUint32(t+f,i,r),e.setUint32(t+a,c,r)}function Oe(e,t,n){return e&t^~e&n}function Re(e,t,n){return e&t^e&n^t&n}var Tt=class extends ut{constructor(t,n,r,s){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=dt(this.buffer)}update(t){lt(this);let{view:n,buffer:r,blockLen:s}=this;t=$(t);let o=t.length;for(let i=0;i<o;){let c=Math.min(s-this.pos,o-i);if(c===s){let f=dt(t);for(;s<=o-i;i+=s)this.process(f,i);continue}r.set(t.subarray(i,i+c),this.pos),this.pos+=c,i+=c,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){lt(this),_e(t,this),this.finished=!0;let{buffer:n,view:r,blockLen:s,isLE:o}=this,{pos:i}=this;n[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>s-i&&(this.process(r,0),i=0);for(let l=i;l<s;l++)n[l]=0;Tn(r,s-8,BigInt(this.length*8),o),this.process(r,0);let c=dt(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let a=f/4,u=this.get();if(a>u.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<a;l++)c.setUint32(4*l,u[l],o)}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:n,buffer:r,length:s,finished:o,destroyed:i,pos:c}=this;return t.length=s,t.pos=c,t.finished=o,t.destroyed=i,s%n&&t.buffer.set(r),t}};var _n=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),et=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),nt=new Uint32Array(64),zt=class extends Tt{constructor(){super(64,32,8,!1),this.A=et[0]|0,this.B=et[1]|0,this.C=et[2]|0,this.D=et[3]|0,this.E=et[4]|0,this.F=et[5]|0,this.G=et[6]|0,this.H=et[7]|0}get(){let{A:t,B:n,C:r,D:s,E:o,F:i,G:c,H:f}=this;return[t,n,r,s,o,i,c,f]}set(t,n,r,s,o,i,c,f){this.A=t|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=o|0,this.F=i|0,this.G=c|0,this.H=f|0}process(t,n){for(let l=0;l<16;l++,n+=4)nt[l]=t.getUint32(n,!1);for(let l=16;l<64;l++){let d=nt[l-15],y=nt[l-2],p=W(d,7)^W(d,18)^d>>>3,h=W(y,17)^W(y,19)^y>>>10;nt[l]=h+nt[l-7]+p+nt[l-16]|0}let{A:r,B:s,C:o,D:i,E:c,F:f,G:a,H:u}=this;for(let l=0;l<64;l++){let d=W(c,6)^W(c,11)^W(c,25),y=u+d+Oe(c,f,a)+_n[l]+nt[l]|0,h=(W(r,2)^W(r,13)^W(r,22))+Re(r,s,o)|0;u=a,a=f,f=c,c=i+y|0,i=o,o=s,s=r,r=y+h|0}r=r+this.A|0,s=s+this.B|0,o=o+this.C|0,i=i+this.D|0,c=c+this.E|0,f=f+this.F|0,a=a+this.G|0,u=u+this.H|0,this.set(r,s,o,i,c,f,a,u)}roundClean(){nt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var Y=Ce(()=>new zt);var Me=BigInt(0);function $t(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function He(e){if(!$t(e))throw new Error("Uint8Array expected")}var In=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Cn(e){He(e);let t="";for(let n=0;n<e.length;n++)t+=In[e[n]];return t}function Sn(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?Me:BigInt("0x"+e)}var Z={_0:48,_9:57,A:65,F:70,a:97,f:102};function Ne(e){if(e>=Z._0&&e<=Z._9)return e-Z._0;if(e>=Z.A&&e<=Z.F)return e-(Z.A-10);if(e>=Z.a&&e<=Z.f)return e-(Z.a-10)}function De(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(n);for(let s=0,o=0;s<n;s++,o+=2){let i=Ne(e.charCodeAt(o)),c=Ne(e.charCodeAt(o+1));if(i===void 0||c===void 0){let f=e[o]+e[o+1];throw new Error(\'hex string expected, got non-hex character "\'+f+\'" at index \'+o)}r[s]=i*16+c}return r}function Gt(e){return He(e),Sn(Cn(Uint8Array.from(e).reverse()))}function kn(e,t){return De(e.toString(16).padStart(t*2,"0"))}function Pe(e,t){return kn(e,t).reverse()}function Xt(e,t,n){let r;if(typeof t=="string")try{r=De(t)}catch(o){throw new Error(e+" must be hex string or Uint8Array, cause: "+o)}else if($t(t))r=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");let s=r.length;if(typeof n=="number"&&s!==n)throw new Error(e+" of length "+n+" expected, got "+s);return r}var Wt=e=>typeof e=="bigint"&&Me<=e;function On(e,t,n){return Wt(e)&&Wt(t)&&Wt(n)&&t<=e&&e<n}function Yt(e,t,n,r){if(!On(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}var Rn={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||$t(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function qe(e,t,n={}){let r=(s,o,i)=>{let c=Rn[o];if(typeof c!="function")throw new Error("invalid validator function");let f=e[s];if(!(i&&f===void 0)&&!c(f,e))throw new Error("param "+String(s)+" is invalid. Expected "+o+", got "+f)};for(let[s,o]of Object.entries(t))r(s,o,!1);for(let[s,o]of Object.entries(n))r(s,o,!0);return e}var ht=BigInt(0),_t=BigInt(1);function It(e,t){let n=e%t;return n>=ht?n:t+n}function Fe(e,t,n){if(t<ht)throw new Error("invalid exponent, negatives unsupported");if(n<=ht)throw new Error("invalid modulus");if(n===_t)return ht;let r=_t;for(;t>ht;)t&_t&&(r=r*e%n),e=e*e%n,t>>=_t;return r}function z(e,t,n){let r=e;for(;t-- >ht;)r*=r,r%=n;return r}var pt=BigInt(0),Zt=BigInt(1);function Nn(e){return qe(e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...e})}function Ke(e){let t=Nn(e),{P:n}=t,r=m=>It(m,n),s=t.montgomeryBits,o=Math.ceil(s/8),i=t.nByteLength,c=t.adjustScalarBytes||(m=>m),f=t.powPminus2||(m=>Fe(m,n-BigInt(2),n));function a(m,E,C){let q=r(m*(E-C));return E=r(E-q),C=r(C+q),[E,C]}let u=(t.a-BigInt(2))/BigInt(4);function l(m,E){Yt("u",m,pt,n),Yt("scalar",E,pt,n);let C=E,q=m,v=Zt,R=pt,M=m,A=Zt,L=pt,B;for(let U=BigInt(s-1);U>=pt;U--){let S=C>>U&Zt;L^=S,B=a(L,v,M),v=B[0],M=B[1],B=a(L,R,A),R=B[0],A=B[1],L=S;let T=v+R,_=r(T*T),I=v-R,k=r(I*I),x=_-k,H=M+A,D=M-A,P=r(D*T),j=r(H*I),G=P+j,X=P-j;M=r(G*G),A=r(q*r(X*X)),v=r(_*k),R=r(x*(_+r(u*x)))}B=a(L,v,M),v=B[0],M=B[1],B=a(L,R,A),R=B[0],A=B[1];let O=f(R);return r(v*O)}function d(m){return Pe(r(m),o)}function y(m){let E=Xt("u coordinate",m,o);return i===32&&(E[31]&=127),Gt(E)}function p(m){let E=Xt("scalar",m),C=E.length;if(C!==o&&C!==i){let q=""+o+" or "+i;throw new Error("invalid scalar, expected "+q+" bytes, got "+C)}return Gt(c(E))}function h(m,E){let C=y(E),q=p(m),v=l(C,q);if(v===pt)throw new Error("invalid private or public key received");return d(v)}let w=d(t.Gu);function b(m){return h(m,w)}return{scalarMult:h,scalarMultBase:b,getSharedSecret:(m,E)=>h(m,E),getPublicKey:m=>b(m),utils:{randomPrivateKey:()=>t.randomBytes(t.nByteLength)},GuBytes:w}}var Qt=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");var Xr=BigInt(0),Mn=BigInt(1),Ve=BigInt(2),Hn=BigInt(3),Dn=BigInt(5),Yr=BigInt(8);function Pn(e){let t=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),o=Qt,c=e*e%o*e%o,f=z(c,Ve,o)*c%o,a=z(f,Mn,o)*e%o,u=z(a,Dn,o)*a%o,l=z(u,t,o)*u%o,d=z(l,n,o)*l%o,y=z(d,r,o)*d%o,p=z(y,s,o)*y%o,h=z(p,s,o)*y%o,w=z(h,t,o)*u%o;return{pow_p_5_8:z(w,Ve,o)*e%o,b2:c}}function qn(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}var mt=Ke({P:Qt,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:e=>{let t=Qt,{pow_p_5_8:n,b2:r}=Pn(e);return It(z(n,Hn,t)*r,t)},adjustScalarBytes:qn,randomBytes:Se});var Ct=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function c(u){try{a(r.next(u))}catch(l){i(l)}}function f(u){try{a(r.throw(u))}catch(l){i(l)}}function a(u){u.done?o(u.value):s(u.value).then(c,f)}a((r=r.apply(e,t||[])).next())})},te=!1,je=!1;var ze=(()=>{let e;return()=>Ct(void 0,void 0,void 0,function*(){if(e===void 0)try{yield crypto.subtle.importKey("raw",mt.GuBytes,{name:"X25519"},te,[]),e=!0}catch{e=!1}return e})})();function ee(e,t){return Ct(this,void 0,void 0,function*(){if(!(yield ze())||je){if(Jt(e))throw new Error("CryptoKey provided but X25519 WebCrypto is not supported");return mt.scalarMult(e,t)}let n;Jt(e)?n=e:n=yield Kn(e);let r=yield crypto.subtle.importKey("raw",t,{name:"X25519"},te,[]);return new Uint8Array(yield crypto.subtle.deriveBits({name:"X25519",public:r},n,256))})}function St(e){return Ct(this,void 0,void 0,function*(){if(!(yield ze())||je){if(Jt(e))throw new Error("CryptoKey provided but X25519 WebCrypto is not supported");return mt.scalarMultBase(e)}return ee(e,mt.GuBytes)})}var Fn=new Uint8Array([48,46,2,1,0,48,5,6,3,43,101,110,4,34,4,32]);function Kn(e){return Ct(this,void 0,void 0,function*(){if(e.length!==32)throw new Error("X25519 private key must be 32 bytes");let t=new Uint8Array([...Fn,...e]);return crypto.subtle.importKey("pkcs8",t,{name:"X25519"},te,["deriveBits"])})}function Jt(e){return typeof CryptoKey<"u"&&e instanceof CryptoKey}function jn(e,t,n,r){rt(e);let s=vt({dkLen:32,asyncTick:10},r),{c:o,dkLen:i,asyncTick:c}=s;if(V(o),V(i),V(c),o<1)throw new Error("PBKDF2: iterations (c) should be >= 1");let f=$(t),a=$(n),u=new Uint8Array(i),l=tt.create(e,f),d=l._cloneInto().update(a);return{c:o,dkLen:i,asyncTick:c,DK:u,PRF:l,PRFSalt:d}}function zn(e,t,n,r,s){return e.destroy(),t.destroy(),r&&r.destroy(),s.fill(0),n}function ne(e,t,n,r){let{c:s,dkLen:o,DK:i,PRF:c,PRFSalt:f}=jn(e,t,n,r),a,u=new Uint8Array(4),l=dt(u),d=new Uint8Array(c.outputLen);for(let y=1,p=0;p<o;y++,p+=c.outputLen){let h=i.subarray(p,p+c.outputLen);l.setInt32(0,y,!1),(a=f._cloneInto(a)).update(u).digestInto(d),h.set(d.subarray(0,h.length));for(let w=1;w<s;w++){c._cloneInto(a).update(d).digestInto(d);for(let b=0;b<h.length;b++)h[b]^=d[b]}}return zn(c,f,i,a,d)}function $e(e,t,n,r,s,o){let i=e[t++]^n[r++],c=e[t++]^n[r++],f=e[t++]^n[r++],a=e[t++]^n[r++],u=e[t++]^n[r++],l=e[t++]^n[r++],d=e[t++]^n[r++],y=e[t++]^n[r++],p=e[t++]^n[r++],h=e[t++]^n[r++],w=e[t++]^n[r++],b=e[t++]^n[r++],m=e[t++]^n[r++],E=e[t++]^n[r++],C=e[t++]^n[r++],q=e[t++]^n[r++],v=i,R=c,M=f,A=a,L=u,B=l,O=d,U=y,S=p,T=h,_=w,I=b,k=m,x=E,H=C,D=q;for(let P=0;P<8;P+=2)L^=N(v+k|0,7),S^=N(L+v|0,9),k^=N(S+L|0,13),v^=N(k+S|0,18),T^=N(B+R|0,7),x^=N(T+B|0,9),R^=N(x+T|0,13),B^=N(R+x|0,18),H^=N(_+O|0,7),M^=N(H+_|0,9),O^=N(M+H|0,13),_^=N(O+M|0,18),A^=N(D+I|0,7),U^=N(A+D|0,9),I^=N(U+A|0,13),D^=N(I+U|0,18),R^=N(v+A|0,7),M^=N(R+v|0,9),A^=N(M+R|0,13),v^=N(A+M|0,18),O^=N(B+L|0,7),U^=N(O+B|0,9),L^=N(U+O|0,13),B^=N(L+U|0,18),I^=N(_+T|0,7),S^=N(I+_|0,9),T^=N(S+I|0,13),_^=N(T+S|0,18),k^=N(D+H|0,7),x^=N(k+D|0,9),H^=N(x+k|0,13),D^=N(H+x|0,18);s[o++]=i+v|0,s[o++]=c+R|0,s[o++]=f+M|0,s[o++]=a+A|0,s[o++]=u+L|0,s[o++]=l+B|0,s[o++]=d+O|0,s[o++]=y+U|0,s[o++]=p+S|0,s[o++]=h+T|0,s[o++]=w+_|0,s[o++]=b+I|0,s[o++]=m+k|0,s[o++]=E+x|0,s[o++]=C+H|0,s[o++]=q+D|0}function re(e,t,n,r,s){let o=r+0,i=r+16*s;for(let c=0;c<16;c++)n[i+c]=e[t+(2*s-1)*16+c];for(let c=0;c<s;c++,o+=16,t+=16)$e(n,i,e,t,n,o),c>0&&(i+=16),$e(n,o,e,t+=16,n,i)}function Wn(e,t,n){let r=vt({dkLen:32,asyncTick:10,maxmem:1073742848},n),{N:s,r:o,p:i,dkLen:c,asyncTick:f,maxmem:a,onProgress:u}=r;if(V(s),V(o),V(i),V(c),V(f),V(a),u!==void 0&&typeof u!="function")throw new Error("progressCb should be function");let l=128*o,d=l/4;if(s<=1||s&s-1||s>2**32)throw new Error("Scrypt: N must be larger than 1, a power of 2, and less than 2^32");if(i<0||i>(2**32-1)*32/l)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(c<0||c>(2**32-1)*32)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");if(l*(s+i)>a)throw new Error("Scrypt: memused is bigger than maxMem. Expected 128 * r * (N + p) > maxmem of "+a);let p=ne(Y,e,t,{c:1,dkLen:l*i}),h=Lt(p),w=Lt(new Uint8Array(l*s)),b=Lt(new Uint8Array(l)),m=()=>{};if(u){let E=2*s*i,C=Math.max(Math.floor(E/1e4),1),q=0;m=()=>{q++,u&&(!(q%C)||q===E)&&u(q/E)}}return{N:s,r:o,p:i,dkLen:c,blockSize32:d,V:w,B32:h,B:p,tmp:b,blockMixCb:m,asyncTick:f}}function $n(e,t,n,r,s){let o=ne(Y,e,n,{c:1,dkLen:t});return n.fill(0),r.fill(0),s.fill(0),o}function Ge(e,t,n){let{N:r,r:s,p:o,dkLen:i,blockSize32:c,V:f,B32:a,B:u,tmp:l,blockMixCb:d}=Wn(e,t,n);Kt||Vt(a);for(let y=0;y<o;y++){let p=c*y;for(let h=0;h<c;h++)f[h]=a[p+h];for(let h=0,w=0;h<r-1;h++)re(f,w,f,w+=c,s),d();re(f,(r-1)*c,a,p,s),d();for(let h=0;h<r;h++){let w=a[p+c-16]%r;for(let b=0;b<c;b++)l[b]=a[p+b]^f[w*c+b];re(l,0,a,p,s),d()}}return Kt||Vt(a),$n(e,i,u,f,l)}function kt(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function oe(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function K(e,...t){if(!oe(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function se(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Xe(e,t){K(e);let n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function ie(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}var Q=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),Ye=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),Gn=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Gn)throw new Error("Non little-endian hardware is not supported");function Xn(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function Ot(e){if(typeof e=="string")e=Xn(e);else if(oe(e))e=Rt(e);else throw new Error("Uint8Array expected, got "+typeof e);return e}function Ze(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}function Qe(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}var ce=(e,t)=>{function n(r,...s){if(K(r),e.nonceLength!==void 0){let u=s[0];if(!u)throw new Error("nonce / iv required");e.varSizeNonce?K(u):K(u,e.nonceLength)}let o=e.tagLength;o&&s[1]!==void 0&&K(s[1]);let i=t(r,...s),c=(u,l)=>{if(l!==void 0){if(u!==2)throw new Error("cipher output not supported");K(l)}},f=!1;return{encrypt(u,l){if(f)throw new Error("cannot encrypt() twice with same key + nonce");return f=!0,K(u),c(i.encrypt.length,l),i.encrypt(u,l)},decrypt(u,l){if(K(u),o&&u.length<o)throw new Error("invalid ciphertext length: smaller than tagLength="+o);return c(i.decrypt.length,l),i.decrypt(u,l)}}}return Object.assign(n,e),n};function fe(e,t,n=!0){if(t===void 0)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(n&&!Yn(t))throw new Error("invalid output, must be aligned");return t}function ae(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let s=BigInt(32),o=BigInt(4294967295),i=Number(n>>s&o),c=Number(n&o),f=r?4:0,a=r?0:4;e.setUint32(t+f,i,r),e.setUint32(t+a,c,r)}function Yn(e){return e.byteOffset%4===0}function Rt(e){return Uint8Array.from(e)}function J(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}var tn=e=>Uint8Array.from(e.split("").map(t=>t.charCodeAt(0))),Zn=tn("expand 16-byte k"),Qn=tn("expand 32-byte k"),Jn=Q(Zn),tr=Q(Qn);function g(e,t){return e<<t|e>>>32-t}function le(e){return e.byteOffset%4===0}var Nt=64,er=16,en=2**32-1,Je=new Uint32Array;function nr(e,t,n,r,s,o,i,c){let f=s.length,a=new Uint8Array(Nt),u=Q(a),l=le(s)&&le(o),d=l?Q(s):Je,y=l?Q(o):Je;for(let p=0;p<f;i++){if(e(t,n,r,u,i,c),i>=en)throw new Error("arx: counter overflow");let h=Math.min(Nt,f-p);if(l&&h===Nt){let w=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let b=0,m;b<er;b++)m=w+b,y[m]=d[m]^u[b];p+=Nt;continue}for(let w=0,b;w<h;w++)b=p+w,o[b]=s[b]^a[w];p+=h}}function ue(e,t){let{allowShortKeys:n,extendNonceFn:r,counterLength:s,counterRight:o,rounds:i}=Ze({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return kt(s),kt(i),ie(o),ie(n),(c,f,a,u,l=0)=>{K(c),K(f),K(a);let d=a.length;if(u===void 0&&(u=new Uint8Array(d)),K(u),kt(l),l<0||l>=en)throw new Error("arx: counter overflow");if(u.length<d)throw new Error(`arx: output (${u.length}) is shorter than data (${d})`);let y=[],p=c.length,h,w;if(p===32)y.push(h=Rt(c)),w=tr;else if(p===16&&n)h=new Uint8Array(32),h.set(c),h.set(c,16),w=Jn,y.push(h);else throw new Error(`arx: invalid 32-byte key, got length=${p}`);le(f)||y.push(f=Rt(f));let b=Q(h);if(r){if(f.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(w,b,Q(f.subarray(0,16)),b),f=f.subarray(16)}let m=16-s;if(m!==f.length)throw new Error(`arx: nonce must be ${m} or 16 bytes`);if(m!==12){let C=new Uint8Array(12);C.set(f,o?0:12-f.length),f=C,y.push(f)}let E=Q(f);return nr(e,w,b,E,a,u,l,i),J(...y),u}}var F=(e,t)=>e[t++]&255|(e[t++]&255)<<8,de=class{constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=Ot(t),K(t,32);let n=F(t,0),r=F(t,2),s=F(t,4),o=F(t,6),i=F(t,8),c=F(t,10),f=F(t,12),a=F(t,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|s<<6)&7939,this.r[3]=(s>>>7|o<<9)&8191,this.r[4]=(o>>>4|i<<12)&255,this.r[5]=i>>>1&8190,this.r[6]=(i>>>14|c<<2)&8191,this.r[7]=(c>>>11|f<<5)&8065,this.r[8]=(f>>>8|a<<8)&8191,this.r[9]=a>>>5&127;for(let u=0;u<8;u++)this.pad[u]=F(t,16+2*u)}process(t,n,r=!1){let s=r?0:2048,{h:o,r:i}=this,c=i[0],f=i[1],a=i[2],u=i[3],l=i[4],d=i[5],y=i[6],p=i[7],h=i[8],w=i[9],b=F(t,n+0),m=F(t,n+2),E=F(t,n+4),C=F(t,n+6),q=F(t,n+8),v=F(t,n+10),R=F(t,n+12),M=F(t,n+14),A=o[0]+(b&8191),L=o[1]+((b>>>13|m<<3)&8191),B=o[2]+((m>>>10|E<<6)&8191),O=o[3]+((E>>>7|C<<9)&8191),U=o[4]+((C>>>4|q<<12)&8191),S=o[5]+(q>>>1&8191),T=o[6]+((q>>>14|v<<2)&8191),_=o[7]+((v>>>11|R<<5)&8191),I=o[8]+((R>>>8|M<<8)&8191),k=o[9]+(M>>>5|s),x=0,H=x+A*c+L*(5*w)+B*(5*h)+O*(5*p)+U*(5*y);x=H>>>13,H&=8191,H+=S*(5*d)+T*(5*l)+_*(5*u)+I*(5*a)+k*(5*f),x+=H>>>13,H&=8191;let D=x+A*f+L*c+B*(5*w)+O*(5*h)+U*(5*p);x=D>>>13,D&=8191,D+=S*(5*y)+T*(5*d)+_*(5*l)+I*(5*u)+k*(5*a),x+=D>>>13,D&=8191;let P=x+A*a+L*f+B*c+O*(5*w)+U*(5*h);x=P>>>13,P&=8191,P+=S*(5*p)+T*(5*y)+_*(5*d)+I*(5*l)+k*(5*u),x+=P>>>13,P&=8191;let j=x+A*u+L*a+B*f+O*c+U*(5*w);x=j>>>13,j&=8191,j+=S*(5*h)+T*(5*p)+_*(5*y)+I*(5*d)+k*(5*l),x+=j>>>13,j&=8191;let G=x+A*l+L*u+B*a+O*f+U*c;x=G>>>13,G&=8191,G+=S*(5*w)+T*(5*h)+_*(5*p)+I*(5*y)+k*(5*d),x+=G>>>13,G&=8191;let X=x+A*d+L*l+B*u+O*a+U*f;x=X>>>13,X&=8191,X+=S*c+T*(5*w)+_*(5*h)+I*(5*p)+k*(5*y),x+=X>>>13,X&=8191;let st=x+A*y+L*d+B*l+O*u+U*a;x=st>>>13,st&=8191,st+=S*f+T*c+_*(5*w)+I*(5*h)+k*(5*p),x+=st>>>13,st&=8191;let it=x+A*p+L*y+B*d+O*l+U*u;x=it>>>13,it&=8191,it+=S*a+T*f+_*c+I*(5*w)+k*(5*h),x+=it>>>13,it&=8191;let ct=x+A*h+L*p+B*y+O*d+U*l;x=ct>>>13,ct&=8191,ct+=S*u+T*a+_*f+I*c+k*(5*w),x+=ct>>>13,ct&=8191;let ft=x+A*w+L*h+B*p+O*y+U*d;x=ft>>>13,ft&=8191,ft+=S*l+T*u+_*a+I*f+k*c,x+=ft>>>13,ft&=8191,x=(x<<2)+x|0,x=x+H|0,H=x&8191,x=x>>>13,D+=x,o[0]=H,o[1]=D,o[2]=P,o[3]=j,o[4]=G,o[5]=X,o[6]=st,o[7]=it,o[8]=ct,o[9]=ft}finalize(){let{h:t,pad:n}=this,r=new Uint16Array(10),s=t[1]>>>13;t[1]&=8191;for(let c=2;c<10;c++)t[c]+=s,s=t[c]>>>13,t[c]&=8191;t[0]+=s*5,s=t[0]>>>13,t[0]&=8191,t[1]+=s,s=t[1]>>>13,t[1]&=8191,t[2]+=s,r[0]=t[0]+5,s=r[0]>>>13,r[0]&=8191;for(let c=1;c<10;c++)r[c]=t[c]+s,s=r[c]>>>13,r[c]&=8191;r[9]-=8192;let o=(s^1)-1;for(let c=0;c<10;c++)r[c]&=o;o=~o;for(let c=0;c<10;c++)t[c]=t[c]&o|r[c];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let i=t[0]+n[0];t[0]=i&65535;for(let c=1;c<8;c++)i=(t[c]+n[c]|0)+(i>>>16)|0,t[c]=i&65535;J(r)}update(t){se(this);let{buffer:n,blockLen:r}=this;t=Ot(t);let s=t.length;for(let o=0;o<s;){let i=Math.min(r-this.pos,s-o);if(i===r){for(;r<=s-o;o+=r)this.process(t,o);continue}n.set(t.subarray(o,o+i),this.pos),this.pos+=i,o+=i,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){J(this.h,this.r,this.buffer,this.pad)}digestInto(t){se(this),Xe(t,this),this.finished=!0;let{buffer:n,h:r}=this,{pos:s}=this;if(s){for(n[s++]=1;s<16;s++)n[s]=0;this.process(n,0,!0)}this.finalize();let o=0;for(let i=0;i<8;i++)t[o++]=r[i]>>>0,t[o++]=r[i]>>>8;return t}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}};function rr(e){let t=(r,s)=>e(s).update(Ot(r)).digest(),n=e(new Uint8Array(32));return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}var nn=rr(e=>new de(e));function sn(e,t,n,r,s,o=20){let i=e[0],c=e[1],f=e[2],a=e[3],u=t[0],l=t[1],d=t[2],y=t[3],p=t[4],h=t[5],w=t[6],b=t[7],m=s,E=n[0],C=n[1],q=n[2],v=i,R=c,M=f,A=a,L=u,B=l,O=d,U=y,S=p,T=h,_=w,I=b,k=m,x=E,H=C,D=q;for(let j=0;j<o;j+=2)v=v+L|0,k=g(k^v,16),S=S+k|0,L=g(L^S,12),v=v+L|0,k=g(k^v,8),S=S+k|0,L=g(L^S,7),R=R+B|0,x=g(x^R,16),T=T+x|0,B=g(B^T,12),R=R+B|0,x=g(x^R,8),T=T+x|0,B=g(B^T,7),M=M+O|0,H=g(H^M,16),_=_+H|0,O=g(O^_,12),M=M+O|0,H=g(H^M,8),_=_+H|0,O=g(O^_,7),A=A+U|0,D=g(D^A,16),I=I+D|0,U=g(U^I,12),A=A+U|0,D=g(D^A,8),I=I+D|0,U=g(U^I,7),v=v+B|0,D=g(D^v,16),_=_+D|0,B=g(B^_,12),v=v+B|0,D=g(D^v,8),_=_+D|0,B=g(B^_,7),R=R+O|0,k=g(k^R,16),I=I+k|0,O=g(O^I,12),R=R+O|0,k=g(k^R,8),I=I+k|0,O=g(O^I,7),M=M+U|0,x=g(x^M,16),S=S+x|0,U=g(U^S,12),M=M+U|0,x=g(x^M,8),S=S+x|0,U=g(U^S,7),A=A+L|0,H=g(H^A,16),T=T+H|0,L=g(L^T,12),A=A+L|0,H=g(H^A,8),T=T+H|0,L=g(L^T,7);let P=0;r[P++]=i+v|0,r[P++]=c+R|0,r[P++]=f+M|0,r[P++]=a+A|0,r[P++]=u+L|0,r[P++]=l+B|0,r[P++]=d+O|0,r[P++]=y+U|0,r[P++]=p+S|0,r[P++]=h+T|0,r[P++]=w+_|0,r[P++]=b+I|0,r[P++]=m+k|0,r[P++]=E+x|0,r[P++]=C+H|0,r[P++]=q+D|0}function or(e,t,n,r){let s=e[0],o=e[1],i=e[2],c=e[3],f=t[0],a=t[1],u=t[2],l=t[3],d=t[4],y=t[5],p=t[6],h=t[7],w=n[0],b=n[1],m=n[2],E=n[3];for(let q=0;q<20;q+=2)s=s+f|0,w=g(w^s,16),d=d+w|0,f=g(f^d,12),s=s+f|0,w=g(w^s,8),d=d+w|0,f=g(f^d,7),o=o+a|0,b=g(b^o,16),y=y+b|0,a=g(a^y,12),o=o+a|0,b=g(b^o,8),y=y+b|0,a=g(a^y,7),i=i+u|0,m=g(m^i,16),p=p+m|0,u=g(u^p,12),i=i+u|0,m=g(m^i,8),p=p+m|0,u=g(u^p,7),c=c+l|0,E=g(E^c,16),h=h+E|0,l=g(l^h,12),c=c+l|0,E=g(E^c,8),h=h+E|0,l=g(l^h,7),s=s+a|0,E=g(E^s,16),p=p+E|0,a=g(a^p,12),s=s+a|0,E=g(E^s,8),p=p+E|0,a=g(a^p,7),o=o+u|0,w=g(w^o,16),h=h+w|0,u=g(u^h,12),o=o+u|0,w=g(w^o,8),h=h+w|0,u=g(u^h,7),i=i+l|0,b=g(b^i,16),d=d+b|0,l=g(l^d,12),i=i+l|0,b=g(b^i,8),d=d+b|0,l=g(l^d,7),c=c+f|0,m=g(m^c,16),y=y+m|0,f=g(f^y,12),c=c+f|0,m=g(m^c,8),y=y+m|0,f=g(f^y,7);let C=0;r[C++]=s,r[C++]=o,r[C++]=i,r[C++]=c,r[C++]=w,r[C++]=b,r[C++]=m,r[C++]=E}var sr=ue(sn,{counterRight:!1,counterLength:4,allowShortKeys:!1}),ir=ue(sn,{counterRight:!1,counterLength:8,extendNonceFn:or,allowShortKeys:!1});var cr=new Uint8Array(16),rn=(e,t)=>{e.update(t);let n=t.length%16;n&&e.update(cr.subarray(n))},fr=new Uint8Array(32);function on(e,t,n,r,s){let o=e(t,n,fr),i=nn.create(o);s&&rn(i,s),rn(i,r);let c=new Uint8Array(16),f=Ye(c);ae(f,0,BigInt(s?s.length:0),!0),ae(f,8,BigInt(r.length),!0),i.update(c);let a=i.digest();return J(o,c),a}var cn=e=>(t,n,r)=>({encrypt(o,i){let c=o.length;i=fe(c+16,i,!1),i.set(o);let f=i.subarray(0,-16);e(t,n,f,f,1);let a=on(e,t,n,f,r);return i.set(a,c),J(a),i},decrypt(o,i){i=fe(o.length-16,i,!1);let c=o.subarray(0,-16),f=o.subarray(-16),a=on(e,t,n,c,r);if(!Qe(f,a))throw new Error("invalid tag");return i.set(o.subarray(0,-16)),e(t,n,i,i,1),J(a),i}}),bt=ce({blockSize:64,nonceLength:12,tagLength:16},cn(sr)),Ao=ce({blockSize:64,nonceLength:24,tagLength:16},cn(ir));var Mt=class{constructor(t,n){this.args=t,this.body=n}},Et=class{constructor(t){this.arr=t}toString(t){return t.forEach(n=>{if(n<32||n>136)throw Error("invalid non-ASCII byte in header")}),new TextDecoder().decode(t)}readString(t){let n=this.arr.subarray(0,t);return this.arr=this.arr.subarray(t),this.toString(n)}readLine(){let t=this.arr.indexOf(10);if(t>=0){let n=this.arr.subarray(0,t);return this.arr=this.arr.subarray(t+1),this.toString(n)}return null}rest(){return this.arr}};function ar(e){let t=new Et(e);if(t.readString(3)!=="-> ")throw Error("invalid stanza");let n=t.readLine();if(n===null)throw Error("invalid stanza");let r=n.split(" ");if(r.length<1)throw Error("invalid stanza");for(let i of r)if(i.length===0)throw Error("invalid stanza");let s=[];for(;;){let i=t.readLine();if(i===null)throw Error("invalid stanza");let c=at.decode(i);if(c.length>48)throw Error("invalid stanza");if(s.push(c),c.length<48)break}let o=lr(s);return[new Mt(r,o),t.rest()]}function lr(e){let t=e.reduce((s,o)=>s+o.length,0),n=new Uint8Array(t),r=0;for(let s of e)n.set(s,r),r+=s.length;return n}function fn(e){let t=new Et(e),n=t.readLine();if(n!=="age-encryption.org/v1")throw Error("invalid version "+(n??"line"));let r=t.rest(),s=[];for(;;){let o;[o,r]=ar(r),s.push(o);let i=new Et(r);if(i.readString(4)==="--- "){let c=e.subarray(0,e.length-i.rest().length-1),f=i.readLine();if(f===null)throw Error("invalid header");let a=at.decode(f);return{recipients:s,headerNoMAC:c,MAC:a,rest:i.rest()}}}}var ur=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function c(u){try{a(r.next(u))}catch(l){i(l)}}function f(u){try{a(r.throw(u))}catch(l){i(l)}}function a(u){u.done?o(u.value):s(u.value).then(c,f)}a((r=r.apply(e,t||[])).next())})};function an(e,t){return ur(this,void 0,void 0,function*(){if(e.args.length<1||e.args[0]!=="X25519")return null;if(e.args.length!==2)throw Error("invalid X25519 stanza");let n=at.decode(e.args[1]);if(n.length!==32)throw Error("invalid X25519 stanza");let r=yield ee(t.identity,n),s=yield t.recipient,o=new Uint8Array(n.length+s.length);o.set(n),o.set(s,n.length);let i=wt(Y,r,o,"age-encryption.org/v1/X25519",32);return un(e.body,i)})}function ln(e,t){if(e.args.length<1||e.args[0]!=="scrypt")return null;if(e.args.length!==3||!/^[1-9][0-9]*$/.test(e.args[2]))throw Error("invalid scrypt stanza");let n=at.decode(e.args[1]);if(n.length!==16)throw Error("invalid scrypt stanza");let r=Number(e.args[2]);if(r>20)throw Error("scrypt work factor is too high");let s="age-encryption.org/v1/scrypt",o=new Uint8Array(s.length+16);o.set(new TextEncoder().encode(s)),o.set(n,s.length);let i=Ge(t,o,{N:Math.pow(2,r),r:8,p:1,dkLen:32});return un(e.body,i)}function un(e,t){if(e.length!==32)throw Error("invalid stanza");let n=new Uint8Array(12);try{return bt(t,n).decrypt(e)}catch{return null}}var dn=16,dr=64*1024,Ht=dr+dn;function hn(e,t){let n=new Uint8Array(12),r=()=>{for(let a=n.length-2;a>=0&&(n[a]++,n[a]===0);a--);},o=Math.ceil(t.length/Ht)*dn,i=new Uint8Array(t.length-o),c=i;for(;t.length>Ht;){let a=bt(e,n).decrypt(t.subarray(0,Ht));c.set(a),c=c.subarray(a.length),t=t.subarray(Ht),r()}n[11]=1;let f=bt(e,n).decrypt(t);if(c.set(f),f.length===0&&i.length!==0)throw Error("empty final chunk");if(c.length!==f.length)throw Error("stream: internal error: didn\'t fill expected plaintext buffer");return i}var pn=function(e,t,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function c(u){try{a(r.next(u))}catch(l){i(l)}}function f(u){try{a(r.throw(u))}catch(l){i(l)}}function a(u){u.done?o(u.value):s(u.value).then(c,f)}a((r=r.apply(e,t||[])).next())})};var Dt=class{constructor(){this.passphrases=[],this.identities=[]}addPassphrase(t){this.passphrases.push(t)}addIdentity(t){if(pr(t)){this.identities.push({identity:t,recipient:St(t)});return}let n=Te.decodeToBytes(t);if(!t.startsWith("AGE-SECRET-KEY-1")||n.prefix.toUpperCase()!=="AGE-SECRET-KEY-"||n.bytes.length!==32)throw Error("invalid identity");this.identities.push({identity:n.bytes,recipient:St(n.bytes)})}decrypt(t,n){return pn(this,void 0,void 0,function*(){let r=fn(t),s=yield this.unwrapFileKey(r.recipients);if(s===null)throw Error("no identity matched any of the file\'s recipients");let o=wt(Y,s,void 0,"header",32),i=tt(Y,o,r.headerNoMAC);if(!hr(r.MAC,i))throw Error("invalid header HMAC");let c=r.rest.subarray(0,16),f=wt(Y,s,c,"payload",32),a=r.rest.subarray(16),u=hn(f,a);return n==="text"?new TextDecoder().decode(u):u})}unwrapFileKey(t){return pn(this,void 0,void 0,function*(){for(let n of t){if(n.args.length>0&&n.args[0]==="scrypt"&&t.length!==1)throw Error("scrypt recipient is not the only one in the header");for(let r of this.passphrases){let s=ln(n,r);if(s!==null)return s}for(let r of this.identities){let s=yield an(n,r);if(s!==null)return s}}return null})}};function hr(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}function pr(e){return typeof CryptoKey<"u"&&e instanceof CryptoKey}var yn=async(e,t)=>{try{let n=new Dt;return n.addPassphrase(t),{success:!0,value:await n.decrypt(e)}}catch{return{success:!1,error:"DecryptionFailed"}}};var yr=e=>{let t=atob(e),n=t.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=t.charCodeAt(s);return r.buffer};var gn=e=>new Uint8Array(yr(e));var xn=(e,t)=>{let n=new Blob([e]),r=URL.createObjectURL(n),s=document.createElement("a");s.href=r,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)};var wn=()=>{let e=document.getElementById("decryptPassword"),t=document.getElementById("decryptButton");return{decryptPasswordInput:e,decryptButton:t}};var gr="Decrypt File",xr="Decrypting...";var he=(e,t)=>{e.textContent=t?xr:gr,e.disabled=t};var mn=(e=0)=>new Promise(t=>setTimeout(t,e));var bn=(e,t,n,r)=>async()=>{let s=e.value;if(!s){alert("Please enter the decryption password");return}he(t,!0),await mn();let o=gn(n),i=await yn(o,s);he(t,!1),i.success?xn(i.value,r):(console.error("Decryption error:",i.error),alert("Decryption failed. Incorrect password or corrupted file"))};document.addEventListener("DOMContentLoaded",()=>{let{decryptPasswordInput:e,decryptButton:t}=wn(),n=window.base64Ciphertext,r=window.originalFilename;t.addEventListener("click",bn(e,t,n,r))});})();\n/*! Bundled license information:\n\n@scure/base/lib/esm/index.js:\n  (*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) *)\n\n@noble/hashes/esm/utils.js:\n  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)\n\n@noble/curves/esm/abstract/utils.js:\n  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)\n\n@noble/curves/esm/abstract/modular.js:\n  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)\n\n@noble/curves/esm/abstract/montgomery.js:\n  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)\n\n@noble/curves/esm/ed25519.js:\n  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)\n\n@noble/ciphers/esm/utils.js:\n  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)\n*/\n',lr=`<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>ðŸ”’âš¡ Self Decrypt âš¡ðŸ”’</title>
    REPLACE_WITH_STYLES
  </head>
  <body>
    <h1>ðŸ”’âš¡ Decrypt Your File âš¡ðŸ”’</h1>
    <p>Enter the password to decrypt and download the file: <strong>REPLACE_WITH_ORIGINAL_FILENAME</strong></p>
    <input type="password" id="decryptPassword" placeholder="Enter Password to Decrypt">
    <button id="decryptButton">Decrypt File</button>

    <script>
      REPLACE_WITH_SCRIPT_BUNDLE
      // placeholders replaced at encrypted file generation time
      window.base64Ciphertext = 'REPLACE_WITH_ENCRYPTED_DATA'
      window.originalFilename = 'REPLACE_WITH_ORIGINAL_FILENAME'
    <\/script>
  </body>
</html>`,ur=`:root {
  font-family: Inter, system-ui, Avenir, Helvetica, Arial, sans-serif;
  line-height: 1.5;
  font-weight: 400;

  color-scheme: light dark;
  color: rgba(255, 255, 255, 0.87);
  background-color: #242424;

  font-synthesis: none;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

body {
  margin: 0 auto;
  padding: 2rem;
  text-align: center;
}

@media (prefers-color-scheme: light) {
  :root {
    color: #213547;
    background-color: #ffffff;
  }
  a:hover {
    color: #747bff;
  }
  button {
    background-color: #f9f9f9;
  }
}
`,hr=(e,t,n,o,i)=>async()=>{var u;const r=(u=e.files)==null?void 0:u[0],s=t.value;if(!r||!s){alert("Please select a file and enter a password");return}fe(i,!0),await fr();const c=await er(r,s);if(fe(i,!1),!c.success){console.error("Encryption error:",c.error),alert("Encryption failed. See console for details");return}const f=sr(c.value.buffer),a=cr(lr,{REPLACE_WITH_SCRIPT_BUNDLE:ar,REPLACE_WITH_STYLES:`<style>${ur}</style>`,REPLACE_WITH_ORIGINAL_FILENAME:r.name,REPLACE_WITH_ENCRYPTED_DATA:f});nr(a,"SelfDecrypt.html",o,n)},dr=`<div>
  <h1>ðŸ”’âš¡ Encrypt Your File âš¡ðŸ”’</h1>

  <input type="file" id="fileInput">
  <input type="password" id="passwordInput" placeholder="Enter Password">
  <button id="encryptButton">Encrypt File</button>

  <div id="downloadLinkContainer" style="display: none;">
    <a id="downloadLink" download="SelfDecrypt.html">Download Self Decrypting HTML</a>
  </div>
</div>`;document.querySelector("body").innerHTML=dr;document.addEventListener("DOMContentLoaded",()=>{const{fileInput:e,passwordInput:t,encryptButton:n,downloadLinkContainer:o,downloadLink:i}=rr();n.addEventListener("click",hr(e,t,o,i,n))});</script>
    <style rel="stylesheet" crossorigin>:root{font-family:Inter,system-ui,Avenir,Helvetica,Arial,sans-serif;line-height:1.5;font-weight:400;color-scheme:light dark;color:#ffffffde;background-color:#242424;font-synthesis:none;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}body{margin:0 auto;padding:2rem;text-align:center}@media (prefers-color-scheme: light){:root{color:#213547;background-color:#fff}a:hover{color:#747bff}button{background-color:#f9f9f9}}</style>
  </head>
  <body>
  </body>
</html>
